% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode,linktoc=all}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  a4paper,
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Pattern Matching and Substitution in bash},
  pdfauthor={R (Chandra) Chandrasekhar},
  pdflang={en-GB},
  colorlinks=true,
  linkcolor={DarkOliveGreen},
  filecolor={Purple},
  citecolor={DarkKhaki},
  urlcolor={Maroon},
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=25mm]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{48,48,48}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.81,0.69}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.50,0.62,0.50}{\textbf{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.80,0.80,0.80}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.86,0.64,0.64}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.80,0.80,0.80}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.86,0.64,0.64}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.50,0.62,0.50}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.50,0.62,0.50}{\textbf{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.86,0.64,0.64}{\textbf{#1}}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.94,0.87,0.69}{#1}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.87,0.87,0.75}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.86,0.86,0.80}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.50,0.62,0.50}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.76,0.75,0.62}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.80,0.80,0.80}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.75,0.75,0.82}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.94,0.94,0.56}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.80,0.80,0.80}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.50,0.62,0.50}{\textbf{#1}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.94,0.87,0.69}{#1}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.80,0.80,0.80}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.94,0.94,0.82}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.94,0.94,0.56}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{1.00,0.81,0.69}{\textbf{#1}}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.80,0.80,0.80}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.86,0.64,0.64}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.80,0.58,0.58}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.80,0.58,0.58}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.80,0.80,0.80}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.80,0.58,0.58}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.50,0.62,0.50}{\textbf{#1}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslentryspacingunit} % times entry-spacing
\setlength{\cslentryspacingunit}{\parskip}
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
  \let\oldpar\par
  \def\par{\hangindent=\cslhangindent\oldpar}
  \fi
  % set entry spacing
  \setlength{\parskip}{#2\cslentryspacingunit}
 }%
 {}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}\break}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}
\ifLuaTeX
\usepackage[bidi=basic]{babel}
\else
\usepackage[bidi=default]{babel}
\fi
\babelprovide[main,import]{british}
% get rid of language-specific shorthands (see #6817):
\let\LanguageShortHands\languageshorthands
\def\languageshorthands#1{}
% $HOME/.pandoc/defaults/latex-header-includes.tex
% Common header includes for both lualatex and xelatex engines.
%
% Preliminaries
%
% \PassOptionsToPackage{rgb,dvipsnames,svgnames}{xcolor}
% \PassOptionsToPackage{main=british}{babel}
\AtBeginEnvironment{quote}{\small}
\AtBeginEnvironment{quotation}{\small}
\AtBeginEnvironment{longtable}{\centering}
%
% Packages that are useful to include
%
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage[inkscapeversion=1]{svg}
\usepackage[defaultlines=4,all]{nowidow}
\usepackage[capitalize,noabbrev]{cleveref}
\usepackage{etoolbox}
\usepackage{fontsize}
\usepackage{newunicodechar}
\usepackage{pdflscape}
\usepackage{fnpct}
\usepackage{parskip}
  \setlength{\parindent}{0pt}
\usepackage[style=american]{csquotes}
% \usepackage{setspace} Use the <fontname-plus.tex> files for setspace
%
% noto-plus.tex
% Font-setting header file for use with Pandoc Markdown
% to generate PDF via LuaLaTeX.
% The main font is Noto Serif.
% Other main fonts are also available in appropriately named file.
\usepackage{fontspec}
\usepackage{setspace}
\setstretch{1.3}
%
\defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase,Renderer=Node} % at the start always
%
% For English
% See also https://tex.stackexchange.com/questions/574047/lualatex-amsthm-polyglossia-charissil-error
% We use Node as Renderer for the Latin Font and Greek Font and HarfBuzz as renderer ofr Indic fonts.
%
\babelfont{rm}[Script=Latin,Scale=1]{NotoSerif}% Config is at $HOME/texmf/tex/latex/NotoSerif.fontspec
%
\babelfont{sf}[Script=Latin]{SourceSansPro}% Config is at $HOME/texmf/tex/latex/SourceSansPro.fontspec
%
\babelfont{tt}[Script=Latin]{FiraMono}% Config is at $HOME/texmf/tex/latex/FiraMono.fontspec
%
% Sanskrit, Tamil, and Greek fonts
%
\babelprovide[import, onchar=ids fonts]{sanskrit}
\babelprovide[import, onchar=ids fonts]{tamil}
\babelprovide[import, onchar=ids fonts]{greek}
%
\babelfont[sanskrit]{rm}[Scale=1.1,Renderer=HarfBuzz,Script=Devanagari]{NotoSerifDevanagari}
\babelfont[sanskrit]{sf}[Scale=1.1,Renderer=HarfBuzz,Script=Devanagari]{NotoSansDevanagari}
\babelfont[tamil]{rm}[Renderer=HarfBuzz,Script=Tamil]{NotoSerifTamil}
\babelfont[tamil]{sf}[Renderer=HarfBuzz,Script=Tamil]{NotoSansTamil}
\babelfont[greek]{rm}[Script=Greek]{GentiumBookPlus}
%
% Math font
%
\usepackage{unicode-math} % seems not to hurt % fallabck
\setmathfont[bold-style=TeX]{STIX Two Math}
%
%
% Other fonts
%
\newfontfamily{\emojifont}{Symbola}
%

\usepackage{titling}
\usepackage{fancyhdr}
    \pagestyle{fancy}
    \fancyhead{}
    \fancyfoot{}
    \renewcommand{\headrulewidth}{0.2pt}
    \renewcommand{\footrulewidth}{0.2pt}
    \fancyhead[LO,RE]{\scshape\thetitle}
    \fancyfoot[CO,CE]{\footnotesize Copyright © 2006\textendash\the\year, R (Chandra) Chandrasekhar}
    \fancyfoot[RE,RO]{\thepage}
\newfontfamily{\regulariconfont}{Font Awesome 6 Free Regular}[Color=Grey]
\newfontfamily{\solidiconfont}{Font Awesome 6 Free Solid}[Color=Grey]
\newfontfamily{\brandsiconfont}{Font Awesome 6 Brands}[Color=Grey]
%
% Direct input of Unicode code points
%
\newcommand{\faEnvelope}{\regulariconfont\ ^^^^f0e0\normalfont}
\newcommand{\faMobile}{\solidiconfont\ ^^^^f3cd\normalfont}
\newcommand{\faLinkedin}{\brandsiconfont\ ^^^^f0e1\normalfont}
\newcommand{\faGithub}{\brandsiconfont\ ^^^^f09b\normalfont}
\newcommand{\faAtom}{\solidiconfont\ ^^^^f5d2\normalfont}
\newcommand{\faPaperPlaneRegular}{\regulariconfont\ ^^^^f1d8\normalfont}
\newcommand{\faPaperPlaneSolid}{\solidiconfont\ ^^^^f1d8\normalfont}

%
% The block below is commented out because of Tofu glyphs in HTML
%
% \newcommand{\faEnvelope}{\regulariconfont\ \normalfont}
% \newcommand{\faMobile}{\solidiconfont\ \normalfont}
% \newcommand{\faLinkedin}{\brandsiconfont\ \normalfont}
% \newcommand{\faGithub}{\brandsiconfont\ \normalfont}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{Pattern Matching and Substitution in \texttt{bash}}
\author{R (Chandra) Chandrasekhar}
\date{2023-02-28 | 2023-03-01}

\begin{document}
\maketitle

\thispagestyle{empty}


\hypertarget{parsing-filenames}{%
\section{Parsing filenames}\label{parsing-filenames}}

A fully qualified filename consists of a \texttt{path}, a
\texttt{basename}, and a file \texttt{extension}. While not all
filenames are encountered in their full glory, it helps to decompose any
given filename into its constituent parts to help with housekeeping
functions on a machine running \texttt{bash}---for example, to
facilitate searching, sorting and other file-related functions.

\hypertarget{extended-globbing}{%
\subsection{Extended globbing}\label{extended-globbing}}

\emph{Globbing} is the unflattering term---abbreviation for
\emph{global}---used to denote an operation to extract files satisfying
certain conditions \protect\hyperlink{ref-glob2023}{{[}1{]}}. It is
applicable also to the \texttt{bash} command line. For our purposes, it
is useful and sometimes mandatory to set \texttt{shopt\ -s\ extglob}
after the \href{https://en.wikipedia.org/wiki/Shebang_(Unix)}{shebang}
line.

\hypertarget{a-canonical-filename}{%
\subsection{A canonical filename}\label{a-canonical-filename}}

A canonical filename will comprise these components:

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  a \emph{path} with the forward slash \texttt{/} as the separator
  between elements denoting the path;
\item
  a filename comprising a \emph{basename} which appears immediately
  after the \emph{last} \texttt{/} character;
\item
  a \emph{file extension} that occurs after the basename immediately
  after a \texttt{.} or period character.
\end{enumerate}

\texttt{/my\_path/is/quite/long/basename.ext} is a canonical filename
where the abovenamed elements are as follows:

\begin{enumerate}
\tightlist
\item
  path: \texttt{/my\_path/is/quite/long/}
\item
  basename: \texttt{basename}
\item
  extension: \texttt{ext}
\item
  filename: \texttt{basename.ext}
\end{enumerate}

\hypertarget{parsing-the-filename}{%
\subsection{Parsing the filename}\label{parsing-the-filename}}

Our next task is to dissect the canonical filename into its above
components using \texttt{bashisms}:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#!/bin/bash}
\BuiltInTok{shopt} \AttributeTok{{-}s}\NormalTok{ extglob}

\VariableTok{fullname}\OperatorTok{=}\StringTok{"/my\_path/is/quite/long/basename.ext"}
\BuiltInTok{echo} \StringTok{"fullname is }\VariableTok{$\{fullname\}}\StringTok{"}

\CommentTok{\#}
\CommentTok{\# Extract path}
\CommentTok{\# Approach from the right until the \_first\_ \textasciigrave{}/\textasciigrave{} is encountered}
\CommentTok{\# and throw away everything from the \_right\_ end up to and including that \textasciigrave{}/\textasciigrave{}.}
\CommentTok{\#}
\VariableTok{path}\OperatorTok{=}\StringTok{"}\VariableTok{$\{fullname}\OperatorTok{\%}\NormalTok{/}\PreprocessorTok{*}\VariableTok{\}}\StringTok{"}
\BuiltInTok{echo} \StringTok{"path is }\VariableTok{$\{fullname}\OperatorTok{\%}\NormalTok{/}\PreprocessorTok{*}\VariableTok{\}}\StringTok{"}

\CommentTok{\#}
\CommentTok{\# Extract filename}
\CommentTok{\# Approach from the left until the \_last\_+ \textasciigrave{}/\textasciigrave{} character is encountered}
\CommentTok{\# and throw away everything from the \_left\_ end up to and including that \textasciigrave{}/\textasciigrave{}.}
\CommentTok{\#}
\VariableTok{filename}\OperatorTok{=}\StringTok{"}\VariableTok{$\{fullname}\OperatorTok{\#\#}\PreprocessorTok{*}\NormalTok{/}\VariableTok{\}}\StringTok{"}
\BuiltInTok{echo} \StringTok{"filename is }\VariableTok{$\{fullname}\OperatorTok{\#\#}\PreprocessorTok{*}\NormalTok{/}\VariableTok{\}}\StringTok{"}

\CommentTok{\#}
\CommentTok{\# Extract file extension}
\CommentTok{\# Approach from the \_left\_ until the \_last\_ \textasciigrave{}.\textasciigrave{} character is encountered}
\CommentTok{\# and throw away everything from the \_left\_ up to and including that last \textasciigrave{}.\textasciigrave{}.}
\CommentTok{\#}
\VariableTok{ext}\OperatorTok{=}\StringTok{"}\VariableTok{$\{fullname}\OperatorTok{\#\#}\PreprocessorTok{*}\NormalTok{.}\VariableTok{\}}\StringTok{"}
\BuiltInTok{echo} \StringTok{"extension is }\VariableTok{$\{fullname}\OperatorTok{\#\#}\PreprocessorTok{*}\NormalTok{.}\VariableTok{\}}\StringTok{"}

\CommentTok{\#}
\CommentTok{\# Extract basename}
\CommentTok{\# This requires trimming strings from both the left and the right of \textasciigrave{}fullname\textasciigrave{}}
\CommentTok{\# and requires \_two\_ steps.}
\CommentTok{\#}
\CommentTok{\# Instead, we use \textasciigrave{}filename\textasciigrave{} which is already available, and excise the extension.}
\CommentTok{\# For this, we approach from the \_right\_ until we encounter the \_first\_ \textasciigrave{}.\textasciigrave{} character}
\CommentTok{\# and throw away everything from the \_right\_ up to and including that last \textasciigrave{}.\textasciigrave{}.}
\CommentTok{\#}
\VariableTok{basename}\OperatorTok{=}\StringTok{"}\VariableTok{$\{filename}\OperatorTok{\%}\NormalTok{.}\PreprocessorTok{*}\VariableTok{\}}\StringTok{"}
\BuiltInTok{echo} \StringTok{"basename is }\VariableTok{$\{filename}\OperatorTok{\%}\NormalTok{.}\PreprocessorTok{*}\VariableTok{\}}\StringTok{"}
\end{Highlighting}
\end{Shaded}

\hypertarget{mnemonics-behind-the-and-symbols}{%
\subsection{\texorpdfstring{Mnemonics behind the \texttt{\#} and
\texttt{\%}
symbols}{Mnemonics behind the \# and \% symbols}}\label{mnemonics-behind-the-and-symbols}}

The use of the symbols \texttt{\#} and \texttt{\%} in the pattern
matching expressions might seem arbitrary or whimsical. For a start,
they do not conform to the usual delimiters \texttt{\^{}} and
\texttt{\$} for the beginning and end of a line. Because we are not
line-oriented here, those symbols are not used.

One other point to keep in view constantly is t avoid looking at
\texttt{bash} pattern matching through the lens of
\href{https://www.regular-expressions.info/tutorial.html}{regular
expressions}. There are some similarities but the two are not identical.

So,
\href{https://www.ldoceonline.com/dictionary/the-dope-on-somebody-something}{what's
the dope} on \texttt{\#} and \texttt{\%}? These two symbols have been
chosen for their near universal usage a prefix and suffix respectively.
It is customary to write \texttt{\#1} for ``number one'' and
\texttt{20\%} for ``twenty percent'' where you will notice that the
\texttt{\#} is written as a \emph{prefix} and the \texttt{\%} is written
as a \emph{suffix} to the number.

In the \texttt{bash} pattern-matching we have encountered so far, we are
matching elements in a string and throwing away the matching portion,
using some known delimiter. When we match from the left, we use
\texttt{\#} because it is a prefix. Likewise, when we match from the
right, we use \texttt{\%}, which is a suffix. In both cases, we stop at
the first match from whichever direction we are starting the match. The
single \texttt{\#} and \texttt{\%} therefore denote
\href{https://stackoverflow.com/questions/2301285/what-do-lazy-and-greedy-mean-in-the-context-of-regular-expressions}{lazy
matching}.

The symbol \texttt{\#\#} means we deal with the \emph{longest} substring
from the left that matches: a case of
\href{https://www.geeksforgeeks.org/perl-greedy-and-non-greedy-match/}{greedy
matching}.The same applies to \texttt{\%\%}.

If you look carefully, you will see that what we do not care about what
we are throwing away. We can therefore refer to it with the \texttt{*}
character, which denotes one or more characters, whether as a
\href{https://en.wikipedia.org/wiki/Wildcard_character}{wildcard} or a
glob. What \emph{is} important to us, though, is the \emph{delimiter}
that anchors the string that we are trimming off.

This delimiting character will be placed to the right of the \texttt{*}
when used with \texttt{\#} or \texttt{\#\#}, and it will be placed to
the left of \texttt{*} when used with \texttt{\%} or \texttt{\%\%}. You
will notice that the \texttt{/} and \texttt{.} characters obey this
simple, logical placement rule in the code above. In both cases, the
anchoring delimiter is also trimmed off.

\hypertarget{acknowledgements}{%
\subsection{Acknowledgements}\label{acknowledgements}}

\hypertarget{feedback}{%
\subsection{Feedback}\label{feedback}}

Please \href{mailto:feedback.swanlotus@gmail.com}{email me} your
comments and corrections.

\noindent A PDF version of this article is
\href{./pattern-matching-in-bash.pdf}{available for download here}:

\begin{ttfamily}

\begin{small}

\url{https://swanlotus.netlify.app/blogs/pattern-matching-in-bash.pdf}

\end{small}

\end{ttfamily}

\hypertarget{bibliography}{%
\section*{References}\label{bibliography}}
\addcontentsline{toc}{section}{References}

\hypertarget{refs}{}
\begin{CSLReferences}{0}{0}
\leavevmode\vadjust pre{\hypertarget{ref-glob2023}{}}%
\CSLLeftMargin{{[}1{]} }%
\CSLRightInline{Wikipedia, {`Glob (programming)'}, 15-Jan-2023.
{[}Online{]}. Available:
\url{https://en.wikipedia.org/w/index.php?title=Glob_(programming)\&oldid=1133836865}.
{[}Accessed: 28-Feb-2023{]}}

\end{CSLReferences}



\end{document}
